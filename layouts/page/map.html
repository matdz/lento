<!DOCTYPE HTML>

<html>
<head>
    {{ partial "header.html" . }}
  </head>
  <body>
    <div class="container">

      <div class="row">
          <a class="title" href="/">Matteo takes Photos</a>
      </div>

      <div class="row">
        <div class="three columns left-side">
          {{ partial "nav.html"}}
          {{ partial "tag-list.html"}}
        </div>
        <div class="nine columns right-side">
        <div id="my-map" class="left-0 top-0 vh-100 w-100" style="width: 1000px; height: 500px;"></div>
        </div>
      </div>
    </div>
    


<script type="text/javascript">
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const paramCenter = urlParams.get('c');
    const paramZoom = urlParams.get('z');

    var myAPIKey = "1c13a6f47cf74818b03d23cda6cfadb8";

    var map = new maplibregl.Map({
        container: 'my-map',
        style: `https://maps.geoapify.com/v1/styles/osm-bright/style.json?apiKey=${myAPIKey}`,
        attributionControl: false,
        zoomControl: false,
    });
    var nav = new maplibregl.NavigationControl({ showCompass: false });
    map.addControl(nav, 'top-left');
    map.addControl(new maplibregl.AttributionControl({
        compact: true,
    }), 'bottom-right');

    var locations = [{"ID":"08e1394e","Name":"08e1394e","Latitude":33.608089,"Longitude":-7.633528},{"ID":"093a604e","Name":"093a604e","Latitude":-5.892858,"Longitude":39.354553},{"ID":"0e844413","Name":"0e844413","Latitude":31.632131,"Longitude":-7.986119},{"ID":"17bd60ba","Name":"17bd60ba","Latitude":33.606511,"Longitude":-7.631739},{"ID":"1f6a3a5c","Name":"1f6a3a5c","Latitude":38.708889,"Longitude":-9.132753},{"ID":"232daf18","Name":"232daf18","Latitude":44.469094,"Longitude":26.092689},{"ID":"2b1f3091","Name":"2b1f3091","Latitude":44.494489,"Longitude":11.346056},{"ID":"324aaef6","Name":"324aaef6","Latitude":38.710531,"Longitude":-9.173506},{"ID":"327e763a","Name":"327e763a","Latitude":44.431886,"Longitude":26.098708},{"ID":"3560bae9","Name":"3560bae9","Latitude":-3.155542,"Longitude":35.622350},{"ID":"3791ae6a","Name":"3791ae6a","Latitude":25.731825,"Longitude":32.618408},{"ID":"39a88073","Name":"39a88073","Latitude":38.711961,"Longitude":-9.129978},{"ID":"44c34b64","Name":"44c34b64","Latitude":43.267661,"Longitude":-2.934747},{"ID":"4ca898fe","Name":"4ca898fe","Latitude":38.709281,"Longitude":-9.134511},{"ID":"4e5b98e1","Name":"4e5b98e1","Latitude":31.631772,"Longitude":-7.991086},{"ID":"4f07bd8a","Name":"4f07bd8a","Latitude":-3.155081,"Longitude":35.621525},{"ID":"51d33efa","Name":"51d33efa","Latitude":45.411828,"Longitude":11.879514},{"ID":"54c0c26c","Name":"54c0c26c","Latitude":22.336736,"Longitude":31.626817},{"ID":"583b471f","Name":"583b471f","Latitude":44.431819,"Longitude":26.101556},{"ID":"60f69f0f","Name":"60f69f0f","Latitude":39.475328,"Longitude":-0.375619},{"ID":"6442ed58","Name":"6442ed58","Latitude":43.459883,"Longitude":-3.804383},{"ID":"6c8a4d30","Name":"6c8a4d30","Latitude":25.735261,"Longitude":32.614422},{"ID":"6d0fbccb","Name":"6d0fbccb","Latitude":-3.787050,"Longitude":36.038611},{"ID":"6f1eb685","Name":"6f1eb685","Latitude":53.473989,"Longitude":-2.240358},{"ID":"708d5894","Name":"708d5894","Latitude":45.402061,"Longitude":11.881733},{"ID":"79c3a413","Name":"79c3a413","Latitude":31.630983,"Longitude":-7.990133},{"ID":"7fd5525d","Name":"7fd5525d","Latitude":31.632400,"Longitude":-7.988489},{"ID":"82d5c02b","Name":"82d5c02b","Latitude":44.494358,"Longitude":11.342867},{"ID":"835f0aea","Name":"835f0aea","Latitude":-3.160811,"Longitude":35.629550},{"ID":"8fdf4d3f","Name":"8fdf4d3f","Latitude":-3.779986,"Longitude":35.996353},{"ID":"93c04d4f","Name":"93c04d4f","Latitude":44.432153,"Longitude":26.097586},{"ID":"957af4e6","Name":"957af4e6","Latitude":43.269164,"Longitude":-2.932833},{"ID":"986978e3","Name":"986978e3","Latitude":31.626783,"Longitude":-7.987544},{"ID":"9c54e7ff","Name":"9c54e7ff","Latitude":-3.154922,"Longitude":35.621331},{"ID":"9d87d773","Name":"9d87d773","Latitude":25.731561,"Longitude":32.618436},{"ID":"a10bc3f0","Name":"a10bc3f0","Latitude":31.632381,"Longitude":-7.988586},{"ID":"b05e0bcc","Name":"b05e0bcc","Latitude":48.886167,"Longitude":2.342775},{"ID":"b1dbf994","Name":"b1dbf994","Latitude":29.978231,"Longitude":31.132881},{"ID":"babbfa7b","Name":"babbfa7b","Latitude":53.406264,"Longitude":-2.988311},{"ID":"d11b4ef8","Name":"d11b4ef8","Latitude":43.694150,"Longitude":7.258678},{"ID":"da2d7440","Name":"da2d7440","Latitude":30.049647,"Longitude":31.261089},{"ID":"db73f13d","Name":"db73f13d","Latitude":33.607731,"Longitude":-7.622039},{"ID":"db852010","Name":"db852010","Latitude":38.679589,"Longitude":-9.172606},{"ID":"ee4c80e8","Name":"ee4c80e8","Latitude":38.694019,"Longitude":-9.205408},{"ID":"f44d6adb","Name":"f44d6adb","Latitude":-3.155503,"Longitude":35.621925},{"ID":"f575c2a1","Name":"f575c2a1","Latitude":39.452903,"Longitude":-0.348042},{"ID":"f8951b78","Name":"f8951b78","Latitude":31.629142,"Longitude":-7.987542},{"ID":"fd58c523","Name":"fd58c523","Latitude":44.433208,"Longitude":26.098122}];
    for (let i = 0; i < locations.length; i++) {
        var marker = new maplibregl.Marker()
            .setLngLat([locations[i].Longitude, locations[i].Latitude])
            .setPopup(new maplibregl.Popup({ closeButton: false }).setHTML(
                '<p><a href="/img/' + locations[i].Name.toString() + '">' + locations[i].ID + '</a></p>'
            ))
            .addTo(map);
    }


    if (paramZoom != null) {
        map.setZoom(parseFloat(paramZoom));
    }
    if (paramCenter != null) {
        var values = paramCenter.split(",");
        map.setCenter({ lat: parseFloat(values[0]), lon: parseFloat(values[1])});
    }

    var currentBounds = map.getBounds();
    var urlBounds = map.getBounds();
    map.on('move', function() { currentBounds = map.getBounds(); });
    map.on('zoom', function() { currentBounds = map.getBounds(); });

    setInterval(function () {
      if (currentBounds == urlBounds) {
          return
      }
      var {lng, lat} = map.getCenter();
      history.replaceState(
          null,
          "",
          window.location.origin +
            window.location.pathname +
            "?c=" +
            lat.toString() +
            "," +
            lng.toString() +
            "&z=" +
            map.getZoom().toString()
      )
      urlBounds = currentBounds;
    },500);
</script>

<script src="/js/index.min.4c78ca53e81faeffb29ab94c80f4f644f2df563529863bee158b5c34489c39bd.js" defer></script>

  </body>
</html>

